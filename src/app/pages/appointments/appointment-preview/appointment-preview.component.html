@if (isLoading) {
  <div class="p-4">
    <p-card>
      <div class="text-500">Afspraak laden…</div>
    </p-card>
  </div>
} @else if (appointment) {
  <div class="p-4">
    <p-card>
      <ng-template pTemplate="header">
        <div class="p-3 flex justify-content-between align-items-start gap-3">
          <div>
            <h2 class="m-0">
              {{ appointment.client.name }} – {{ appointment.dog.name }}
            </h2>
            <div class="text-500 mt-1">
              <i class="pi pi-calendar mr-2" aria-hidden="true"></i>
              {{ appointment.startTime | date: "EEEE d MMMM yyyy" }}
              <span class="mx-2" aria-hidden="true">•</span>
              <i class="pi pi-clock mr-2" aria-hidden="true"></i>
              {{ appointment.startTime | date: "HH:mm" }} –
              {{ appointment.endTime | date: "HH:mm" }}
            </div>
          </div>

          <div class="flex flex-wrap justify-content-end gap-2">
            @if (appointment.deletedAt) {
              <p-tag value="Gearchiveerd" severity="secondary"></p-tag>
            }
            @if (appointment.completed) {
              <p-tag value="Afgerond" severity="success"></p-tag>
            } @else {
              <p-tag value="Open" severity="info"></p-tag>
            }
          </div>
        </div>
      </ng-template>

      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="font-medium mb-2">Werkzaamheden</div>
          <div class="flex flex-wrap gap-1">
            @for (service of appointment.services ?? []; track service.id) {
              <p-tag [value]="service.name" severity="info"></p-tag>
            } @empty {
              <span class="text-500">Geen</span>
            }
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="font-medium mb-2">Pakketten</div>
          <div class="flex flex-wrap gap-1">
            @for (pkg of appointment.packages ?? []; track pkg.id) {
              <p-tag [value]="pkg.name" severity="success"></p-tag>
            } @empty {
              <span class="text-500">Geen</span>
            }
          </div>
        </div>

        @if (appointment.notes) {
          <div class="col-12">
            <div class="font-medium mb-2">Notities</div>
            <div class="appointment-preview__notes">
              {{ appointment.notes }}
            </div>
          </div>
        }

        @if (appointment.completed) {
          <div class="col-12">
            <div class="font-medium mb-2">Afronding</div>
            <div class="text-500">
              @if (
                appointment.actualPrice !== null &&
                appointment.actualPrice !== undefined
              ) {
                Werkelijke prijs:
                {{ appointment.actualPrice | currency: "EUR" }}
              } @else {
                Werkelijke prijs: onbekend
              }
            </div>
          </div>
        }
      </div>

      <ng-template pTemplate="footer">
        <div class="flex justify-content-end gap-2">
          <p-button
            label="Terug"
            icon="pi pi-arrow-left"
            [text]="true"
            (click)="backToAppointments()"
            ariaLabel="Terug naar afspraken"
          ></p-button>

          <p-button
            label="Bewerken"
            icon="pi pi-pencil"
            (click)="edit()"
            ariaLabel="Afspraak bewerken"
          ></p-button>
        </div>
      </ng-template>
    </p-card>
  </div>
} @else {
  <div class="p-4">
    <p-card>
      <div class="text-500">Afspraak niet gevonden.</div>
      <div class="mt-3">
        <p-button
          label="Terug naar afspraken"
          icon="pi pi-arrow-left"
          (click)="backToAppointments()"
        ></p-button>
      </div>
    </p-card>
  </div>
}
