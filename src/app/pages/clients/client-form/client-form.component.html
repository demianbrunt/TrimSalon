<div class="p-4">
  <p-card [ngClass]="{ 'mobile-card': isMobile }" class="mx-auto max-w-2xl">
    <ng-template pTemplate="title">
      <h2 class="m-0 mb-5">
        {{ isEditMode ? "Klant Bewerken" : "Nieuwe Klant" }}
      </h2>
    </ng-template>
    <form [formGroup]="form" class="p-fluid">
      <div class="field">
        <p-floatlabel>
          <input
            pInputText
            id="naam"
            class="w-full"
            [formControl]="form.controls.name"
            autocomplete="off"
          />
          <label for="naam">Naam</label>
        </p-floatlabel>
      </div>
      <div class="field">
        <p-floatlabel>
          <input
            pInputText
            id="email"
            class="w-full"
            [formControl]="form.controls.email"
            autocomplete="off"
          />
          <label for="email">E-mail</label>
        </p-floatlabel>
      </div>
      <div class="field">
        <p-floatlabel>
          <input
            pInputText
            id="telefoon"
            class="w-full"
            placeholder="+31 6 12345678"
            [formControl]="form.controls.phone"
            autocomplete="off"
          />
          <label for="telefoon">Telefoon</label>
        </p-floatlabel>
      </div>
      <p-divider />
      <div class="flex justify-content-between align-items-center mb-2 w-full">
        <h4 class="m-0">Honden</h4>
        <p-button
          styleClass=""
          size="small"
          icon="pi pi-plus"
          label="Toevoegen"
          (click)="addDog()"
          type="button"
        ></p-button>
      </div>
      @for (dogGroup of dogsArray.controls; track $index) {
        <div
          [formGroup]="$any(dogGroup)"
          class="formgrid grid p-2 align-items-center"
        >
          <div class="field col-12 md:col-5">
            <p-floatlabel>
              <input
                pInputText
                id="naamHond"
                class="w-full"
                [formControl]="dogGroup.controls.name"
                autocomplete="off"
              />
              <label for="email">Naam</label>
            </p-floatlabel>
          </div>
          <div class="field col-12 md:col-5">
            <p-floatlabel class="w-full">
              <p-autocomplete
                class="w-full"
                [formControl]="dogGroup.controls.breed"
                [dropdown]="true"
                [suggestions]="filteredBreeds"
                (completeMethod)="searchBreeds($event)"
                optionLabel="name"
                appendTo="body"
              />
              <label for="ras">Ras</label>
            </p-floatlabel>
          </div>
          @if (canDeleteDog) {
            <div class="field col-12 md:col-2">
              <p-button
                icon="pi pi-trash"
                styleClass="p-button-danger w-full"
                (click)="removeDog($index)"
                type="button"
              ></p-button>
            </div>
          }
        </div>
      }
    </form>
    <ng-template pTemplate="footer">
      <div class="flex justify-content-end gap-2">
        <p-button
          label="Annuleren"
          icon="pi pi-times"
          styleClass="p-button-text"
          (click)="cancel()"
          type="button"
        ></p-button>
        <p-button
          label="Opslaan"
          icon="pi pi-check"
          (click)="saveClient()"
          [disabled]="form?.invalid || isSaving"
        ></p-button>
      </div>
    </ng-template>
  </p-card>
</div>
